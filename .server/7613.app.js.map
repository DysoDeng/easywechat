{"version":3,"file":"7613.app.js","mappings":";;;;;;;;;;;;AAAO;AACP;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;EC1BA;EAAA;EAAA;EAAA;EAAA;;;;;;;;;;;;;;;;;;;;;;EAAA;EAAA;;;;;;;;EAAA;EAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AEA0E;AAC1E;AACA,CAAmC;AACnC;AACA,iDAAiD,2BAAa;AAC9D;AACA,SAAS,SAAS;AAClB;;;AAGA,iDAAe","sources":["webpack:///./.vuepress/.temp/pages/3.x/cache.html.js","webpack:///./.vuepress/.temp/pages/3.x/cache.html.vue","webpack:///./.vuepress/.temp/pages/3.x/cache.html.vue?a772","webpack:///./.vuepress/.temp/pages/3.x/cache.html.vue?0dff"],"sourcesContent":["export const data = {\n  \"key\": \"v-038669a2\",\n  \"path\": \"/3.x/cache.html\",\n  \"title\": \"缓存\",\n  \"lang\": \"en-US\",\n  \"frontmatter\": {},\n  \"excerpt\": \"\",\n  \"headers\": [\n    {\n      \"level\": 3,\n      \"title\": \"Laravel 中使用\",\n      \"slug\": \"laravel-中使用\",\n      \"children\": []\n    },\n    {\n      \"level\": 2,\n      \"title\": \"使用自定义的缓存方式\",\n      \"slug\": \"使用自定义的缓存方式\",\n      \"children\": []\n    }\n  ],\n  \"filePathRelative\": \"3.x/cache.md\",\n  \"git\": {\n    \"updatedTime\": 1629906046000,\n    \"contributors\": []\n  }\n}\n","<h1 id=\"缓存\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#缓存\" aria-hidden=\"true\">#</a> 缓存</h1>\n<p>本项目使用 <a href=\"https://github.com/doctrine/cache\" target=\"_blank\" rel=\"noopener noreferrer\">doctrine/cache<OutboundLink/></a> 来完成缓存工作，它支持基本目前所有的缓存引擎。</p>\n<p>在我们的 SDK 中的所有缓存默认使用文件缓存，缓存路径取决于 PHP 的临时目录，如果你需要自定义缓存，那么你需要做如下的事情：</p>\n<p>你可以参考<a href=\"http://doctrine-orm.readthedocs.org/projects/doctrine-orm/en/latest/reference/caching.html\" target=\"_blank\" rel=\"noopener noreferrer\">doctrine/cache官方文档<OutboundLink/></a>来替换掉应用中默认的缓存配置：</p>\n<blockquote>\n<p>以 redis 为例\n请先安装 redis 拓展：https://github.com/phpredis/phpredis</p>\n</blockquote>\n<div class=\"language-php ext-php line-numbers-mode\"><pre v-pre class=\"language-php\"><code>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Doctrine<span class=\"token punctuation\">\\</span>Common<span class=\"token punctuation\">\\</span>Cache<span class=\"token punctuation\">\\</span>RedisCache</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$cacheDriver</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RedisCache</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 创建 redis 实例</span>\n<span class=\"token variable\">$redis</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Redis</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$redis</span><span class=\"token operator\">-></span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'redis_host'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6379</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$cacheDriver</span><span class=\"token operator\">-></span><span class=\"token function\">setRedis</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$redis</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$options</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string single-quoted-string\">'debug'</span>  <span class=\"token operator\">=></span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string single-quoted-string\">'app_id'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$wechatInfo</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'app_id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string single-quoted-string\">'secret'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$wechatInfo</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'app_secret'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string single-quoted-string\">'token'</span>  <span class=\"token operator\">=></span> <span class=\"token variable\">$wechatInfo</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'token'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string single-quoted-string\">'aes_key'</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$wechatInfo</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'aes_key'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 可选</span>\n    <span class=\"token string single-quoted-string\">'cache'</span>   <span class=\"token operator\">=></span> <span class=\"token variable\">$cacheDriver</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$wechatApp</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Application</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$options</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre><div class=\"line-numbers\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br><span class=\"line-number\">6</span><br><span class=\"line-number\">7</span><br><span class=\"line-number\">8</span><br><span class=\"line-number\">9</span><br><span class=\"line-number\">10</span><br><span class=\"line-number\">11</span><br><span class=\"line-number\">12</span><br><span class=\"line-number\">13</span><br><span class=\"line-number\">14</span><br><span class=\"line-number\">15</span><br><span class=\"line-number\">16</span><br><span class=\"line-number\">17</span><br><span class=\"line-number\">18</span><br><span class=\"line-number\">19</span><br><span class=\"line-number\">20</span><br><span class=\"line-number\">21</span><br></div></div><h3 id=\"laravel-中使用\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#laravel-中使用\" aria-hidden=\"true\">#</a> Laravel 中使用</h3>\n<p>在 Laravel 中框架使用 <a href=\"https://github.com/nrk/predis\" target=\"_blank\" rel=\"noopener noreferrer\">predis/predis<OutboundLink/></a>，那么我们就得使用 <code>Doctrine\\Common\\Cache\\PredisCache</code>：</p>\n<div class=\"language-php ext-php line-numbers-mode\"><pre v-pre class=\"language-php\"><code>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Doctrine<span class=\"token punctuation\">\\</span>Common<span class=\"token punctuation\">\\</span>Cache<span class=\"token punctuation\">\\</span>PredisCache</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$predis</span> <span class=\"token operator\">=</span> <span class=\"token function\">app</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'redis'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">connection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// connection($name), $name 默认为 `default`</span>\n<span class=\"token variable\">$cacheDriver</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PredisCache</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$predis</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$app</span><span class=\"token operator\">-></span><span class=\"token property\">cache</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$cacheDriver</span><span class=\"token punctuation\">;</span>\n</code></pre><div class=\"line-numbers\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br><span class=\"line-number\">6</span><br><span class=\"line-number\">7</span><br></div></div><blockquote>\n<p>上面提到的 <code>app('redis')-&gt;connection($name)</code>, 这里的 <code>$name</code> 是 laravel 项目中配置文件 <code>database.php</code> 中 <code>redis</code> 配置名 <code>default</code>：https://github.com/laravel/laravel/blob/master/config/database.php#L118\n如果你使用的其它连接，对应传名称就好了。\n如果你在使用Laravel 5.4，应将<code>$predis = app('redis')-&gt;connection();</code>修改为：<code>$predis = app('redis')-&gt;connection()-&gt;client();</code></p>\n</blockquote>\n<h2 id=\"使用自定义的缓存方式\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#使用自定义的缓存方式\" aria-hidden=\"true\">#</a> 使用自定义的缓存方式</h2>\n<p>如果你发现 doctrine 提供的几十种缓存方式都满足不了你的需求的话，那么你可以自己建立一个类来完成缓存操作，前提这个类得实现接口：<a href=\"https://github.com/doctrine/cache/blob/master/lib/Doctrine/Common/Cache/Cache.php\" target=\"_blank\" rel=\"noopener noreferrer\">Doctrine\\Common\\Cache\\Cache<OutboundLink/></a></p>\n<p>该接口有以下方法需要实现：</p>\n<div class=\"language-php ext-php line-numbers-mode\"><pre v-pre class=\"language-php\"><code>   <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\">// 读取缓存</span>\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 检查是否存在缓存</span>\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">save</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$data</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$lifeTime</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// 设置缓存</span>\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 删除缓存</span>\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getStats</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 获取状态</span>\n</code></pre><div class=\"line-numbers\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br></div></div><p>下面为一个示例：</p>\n<div class=\"language-php ext-php line-numbers-mode\"><pre v-pre class=\"language-php\"><code><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">Doctrine<span class=\"token punctuation\">\\</span>Common<span class=\"token punctuation\">\\</span>Cache<span class=\"token punctuation\">\\</span>Cache</span> <span class=\"token keyword\">as</span> CacheInterface<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">MyCacheDriver</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">CacheInterface</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 你自己从你想实现的存储方式读取并返回</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 同理 返回存在与否 bool 值</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">save</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$data</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$lifeTime</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 用你的方式存储该缓存内容即可</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 删除并返回 bool 值</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getStats</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 这个你可以不用实现，返回 null 即可</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</span></code></pre><div class=\"line-numbers\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br><span class=\"line-number\">6</span><br><span class=\"line-number\">7</span><br><span class=\"line-number\">8</span><br><span class=\"line-number\">9</span><br><span class=\"line-number\">10</span><br><span class=\"line-number\">11</span><br><span class=\"line-number\">12</span><br><span class=\"line-number\">13</span><br><span class=\"line-number\">14</span><br><span class=\"line-number\">15</span><br><span class=\"line-number\">16</span><br><span class=\"line-number\">17</span><br><span class=\"line-number\">18</span><br><span class=\"line-number\">19</span><br><span class=\"line-number\">20</span><br><span class=\"line-number\">21</span><br><span class=\"line-number\">22</span><br><span class=\"line-number\">23</span><br><span class=\"line-number\">24</span><br><span class=\"line-number\">25</span><br><span class=\"line-number\">26</span><br><span class=\"line-number\">27</span><br><span class=\"line-number\">28</span><br><span class=\"line-number\">29</span><br><span class=\"line-number\">30</span><br><span class=\"line-number\">31</span><br></div></div><p>然后实例化你的缓存类并在 EasyWeChat 里使用它：</p>\n<div class=\"language-php ext-php line-numbers-mode\"><pre v-pre class=\"language-php\"><code><span class=\"token variable\">$myCacheDriver</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MyCacheDriver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$config</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token comment\">//...</span>\n    <span class=\"token string single-quoted-string\">'cache'</span>   <span class=\"token operator\">=></span> <span class=\"token variable\">$myCacheDriver</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$wechatApp</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Application</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$options</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre><div class=\"line-numbers\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br><span class=\"line-number\">6</span><br><span class=\"line-number\">7</span><br><span class=\"line-number\">8</span><br></div></div><p>OK，这样就完成了自定义缓存的操作。</p>\n","export * from \"-!../../../../node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[1]!../../../../node_modules/@vuepress/bundler-webpack/lib/build/ssr/vuepressLoader.js!../../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!./cache.html.vue?vue&type=template&id=50f122a0\"","import { ssrRender } from \"./cache.html.vue?vue&type=template&id=50f122a0\"\nconst script = {}\nimport { ssrContextKey } from 'vue'\nscript.ssrRender = (...args) => {\n  const ssrContext = args[2].appContext.provides[ssrContextKey]\n  ssrContext._registeredComponents.add(\"/home/runner/work/easywechat/easywechat/docs/node_modules/@vuepress/bundler-webpack/lib/build/ssr/vuepressLoader.js!/home/runner/work/easywechat/easywechat/docs/node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!/home/runner/work/easywechat/easywechat/docs/.vuepress/.temp/pages/3.x/cache.html.vue\")\n  return ssrRender(...args)\n}\n\n\nexport default script"],"names":[],"sourceRoot":""}