{"version":3,"file":"assets/js/v-4d2b10b2.4f0ba043.js","mappings":"+GAAO,MAAMA,EAAO,CAClB,IAAO,aACP,KAAQ,6BACR,MAAS,MACT,KAAQ,QACR,YAAe,GACf,QAAW,GACX,QAAW,CACT,CACE,MAAS,EACT,MAAS,cACT,KAAQ,cACR,SAAY,KAGhB,iBAAoB,0BACpB,IAAO,CACL,YAAe,aACf,aAAgB,M,sDClBpB,E,SAAA,6lbCIA,EAHe,CACf,O,qBDFA","sources":["webpack:///./.vuepress/.temp/pages/5.x/open-work/server.html.js","webpack:///./.vuepress/.temp/pages/5.x/open-work/server.html.vue","webpack:///./.vuepress/.temp/pages/5.x/open-work/server.html.vue?02b1"],"sourcesContent":["export const data = {\n  \"key\": \"v-4d2b10b2\",\n  \"path\": \"/5.x/open-work/server.html\",\n  \"title\": \"服务端\",\n  \"lang\": \"en-US\",\n  \"frontmatter\": {},\n  \"excerpt\": \"\",\n  \"headers\": [\n    {\n      \"level\": 2,\n      \"title\": \"企业微信第三方回调协议\",\n      \"slug\": \"企业微信第三方回调协议\",\n      \"children\": []\n    }\n  ],\n  \"filePathRelative\": \"5.x/open-work/server.md\",\n  \"git\": {\n    \"updatedTime\": 1629906046000,\n    \"contributors\": []\n  }\n}\n","<h1 id=\"服务端\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#服务端\" aria-hidden=\"true\">#</a> 服务端</h1>\n<h2 id=\"企业微信第三方回调协议\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#企业微信第三方回调协议\" aria-hidden=\"true\">#</a> 企业微信第三方回调协议</h2>\n<p>SDK 默认会处理事件 <code>suite_ticket</code> ，并会缓存 <code>suite_ticket</code></p>\n<blockquote>\n<p>{info} 需要注意的是：授权成功、变更授权、取消授权通知时间的响应必须在1000ms内完成，以保证用户安装应用的体验。建议在接收到此事件时 立即回应企业微信，之后再做相关业务的处理。</p>\n</blockquote>\n<div class=\"language-php ext-php line-numbers-mode\"><pre v-pre class=\"language-php\"><code><span class=\"token variable\">$server</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$app</span><span class=\"token operator\">-></span><span class=\"token property\">server</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$server</span><span class=\"token operator\">-></span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$message</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//指令回调</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$message</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'InfoType'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$message</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'InfoType'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">//推送suite_ticket</span>\n            <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'suite_ticket'</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//授权成功通知</span>\n            <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'create_auth'</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//变更授权通知</span>\n            <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'cancel_auth'</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//通讯录事件通知</span>\n            <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'change_contact'</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$message</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'ChangeType'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'create_user'</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">'新增成员事件'</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'update_user'</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">'更新成员事件'</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'delete_user'</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">'删除成员事件'</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'create_party'</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">'新增部门事件'</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'update_party'</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">'更新部门事件'</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'delete_party'</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">'删除部门事件'</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'update_tag'</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">'标签成员变更事件'</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">'fail'</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">//数据回调</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$message</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'MsgType'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$message</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'MsgType'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'event'</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">'事件消息'</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//详情 https://work.weixin.qq.com/api/doc/90001/90143/90376#%E5%88%A0%E9%99%A4%E6%88%90%E5%91%98%E4%BA%8B%E4%BB%B6</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'text'</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">'文本消息'</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//详情 https://work.weixin.qq.com/api/doc/90001/90143/90375#%E5%9B%BE%E7%89%87%E6%B6%88%E6%81%AF</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'image'</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">'图片消息'</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token comment\">//等等...不再一一举例</span>\n            <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">return</span> <span class=\"token string single-quoted-string\">'其他消息'</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$server</span><span class=\"token operator\">-></span><span class=\"token function\">serve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$response</span><span class=\"token operator\">-></span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre><div class=\"line-numbers\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br><span class=\"line-number\">6</span><br><span class=\"line-number\">7</span><br><span class=\"line-number\">8</span><br><span class=\"line-number\">9</span><br><span class=\"line-number\">10</span><br><span class=\"line-number\">11</span><br><span class=\"line-number\">12</span><br><span class=\"line-number\">13</span><br><span class=\"line-number\">14</span><br><span class=\"line-number\">15</span><br><span class=\"line-number\">16</span><br><span class=\"line-number\">17</span><br><span class=\"line-number\">18</span><br><span class=\"line-number\">19</span><br><span class=\"line-number\">20</span><br><span class=\"line-number\">21</span><br><span class=\"line-number\">22</span><br><span class=\"line-number\">23</span><br><span class=\"line-number\">24</span><br><span class=\"line-number\">25</span><br><span class=\"line-number\">26</span><br><span class=\"line-number\">27</span><br><span class=\"line-number\">28</span><br><span class=\"line-number\">29</span><br><span class=\"line-number\">30</span><br><span class=\"line-number\">31</span><br><span class=\"line-number\">32</span><br><span class=\"line-number\">33</span><br><span class=\"line-number\">34</span><br><span class=\"line-number\">35</span><br><span class=\"line-number\">36</span><br><span class=\"line-number\">37</span><br><span class=\"line-number\">38</span><br><span class=\"line-number\">39</span><br><span class=\"line-number\">40</span><br><span class=\"line-number\">41</span><br><span class=\"line-number\">42</span><br><span class=\"line-number\">43</span><br><span class=\"line-number\">44</span><br><span class=\"line-number\">45</span><br><span class=\"line-number\">46</span><br><span class=\"line-number\">47</span><br><span class=\"line-number\">48</span><br><span class=\"line-number\">49</span><br><span class=\"line-number\">50</span><br><span class=\"line-number\">51</span><br><span class=\"line-number\">52</span><br><span class=\"line-number\">53</span><br><span class=\"line-number\">54</span><br><span class=\"line-number\">55</span><br><span class=\"line-number\">56</span><br><span class=\"line-number\">57</span><br><span class=\"line-number\">58</span><br><span class=\"line-number\">59</span><br><span class=\"line-number\">60</span><br><span class=\"line-number\">61</span><br><span class=\"line-number\">62</span><br><span class=\"line-number\">63</span><br><span class=\"line-number\">64</span><br><span class=\"line-number\">65</span><br><span class=\"line-number\">66</span><br><span class=\"line-number\">67</span><br><span class=\"line-number\">68</span><br><span class=\"line-number\">69</span><br></div></div>","import { render } from \"./server.html.vue?vue&type=template&id=722d4371\"\nconst script = {}\nscript.render = render\n\nexport default script"],"names":["data"],"sourceRoot":""}